{% extends 'base.html' %}

{% block title %}Profile{% endblock title %}

{% block content %}
<section>
		<div class="feature-photo">
			<figure><img src="{{ profile.background.url }}" alt=""></figure>
			{% if friend_request %}
			<form action="{% url 'profiles:accept-friend' %}" method="post">
				{% csrf_token %}
			<div class="add-btn">
				<span>1205 followers</span>
					<button type="submit">Принять запрос</button>
				<input type="hidden" name="profile_sender" value="{{ profile.id }}">
			</div>
			</form>
			{% endif %}
			{% if receiver == 'not receiver' and friend_request == False %}
			<form action="{% url 'profiles:cancel-or-send-friend-request' %}" method="post">
				{% csrf_token %}
			<div class="add-btn">
				<span>1205 followers</span>
					<button type="submit">Добавить в друзья</button>
					<input type="hidden" name="receiver_id" value="{{ profile.id }}">
			</div>
			</form>
			{% elif receiver == 'receiver' %}
			<form action="{% url 'profiles:cancel-or-send-friend-request' %}" method="post">
				{% csrf_token %}
			<div class="add-btn">
				<span>1205 followers</span>
					<button type="submit">Отменить запрос</button>
				<input type="hidden" name="receiver_id" value="{{ profile.id }}">
			</div>
			</form>
			{% elif request.user in profile.friends.all %}
			<form action="{% url 'profiles:delete-friend' %}" method="post">
				{% csrf_token %}
			<div class="add-btn">
				<span>1205 followers</span>
					<button type="submit">Удалить из друзей</button>
				<input type="hidden" name="profile" value="{{ profile.id }}">
			</div>
			</form>
			{% endif %}
			<div class="edit-phto">
				<i class="fa fa-camera-retro"></i>
				<label class="fileContainer" data-toggle="modal" data-target="#changeBackground">
					Изменить фон
				</label>
			</div>
			<div class="container-fluid">
				<div class="row merged">
					<div class="col-lg-2 col-sm-3" >
						<div class="user-avatar">
							<figure>
								<img src="{{ profile.avatar.url }}" alt="">
								<div class="edit-phto">
									<i class="fa fa-camera-retro"></i>
									<label class="fileContainer" data-toggle="modal" data-target="#changeAvatar">
										Изменить аватар
									</label>
								</div>
							</figure>
						</div>
					</div>
					<div class="col-lg-10 col-sm-9">
						<div class="timeline-info">
							<ul>
								<li class="admin-name">
								  <h5>{{ profile.first_name }} {{ profile.last_name }}</h5>
								  <span>Group Admin</span>
								</li>
								<li>
									<a class="active" href="time-line.html" title="" data-ripple="">Стена</a>
									<a class="" href="timeline-photos.html" title="" data-ripple="">Фотографии</a>
									<a class="" href="timeline-videos.html" title="" data-ripple="">Видео</a>
									<a class="" href="{% url 'profiles:profile-friends' slug=profile.slug %}" title="" data-ripple="">Друзья</a>
									<a class="" href="{% url 'profiles:profile-groups' slug=profile.slug %}" title="" data-ripple="">Группы</a>
									<a class="" href="{% url 'profiles:profile-about' slug=profile.slug %}" title="" data-ripple="">Обо мне</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section><!-- top area -->

	<section>
		<div class="gap gray-bg">
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-12">
						<div class="row" id="page-contents">
							<div class="col-lg-3">
								<aside class="sidebar static">
									<div class="widget">
										<h4 class="widget-title">Информация</h4>
												<div class="tab-pane fade show active" id="basic" >
													<ul class="basics">
														<li><i class="ti-user"></i>{{ profile.first_name }} {{ profile.last_name }}</li>
														<li><i class="ti-map-alt"></i>live in Dubai</li>
														<li><i class="ti-mobile"></i>+1-234-345675</li>
														<li><i class="ti-email"></i><a href="https://wpkixx.com/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3c4553494e515d55507c59515d5550125f5351">[email&#160;protected]</a></li>
														<li><i class="ti-world"></i>www.yoursite.com</li>
														<li>Обо мне <br>www.yoursite.com</li>
													</ul>
												</div>
									</div>

									{% include 'shortcuts.html' %} <!-- Shortcuts -->

									<div class="widget">
										<h4 class="widget-title">Recent Activity</h4>
										<ul class="activitiez">
											<li>
												<div class="activity-meta">
													<i>10 hours Ago</i>
													<span><a href="#" title="">Commented on Video posted </a></span>
													<h6>by <a href="newsfeed.html">black demon.</a></h6>
												</div>
											</li>
											<li>
												<div class="activity-meta">
													<i>30 Days Ago</i>
													<span><a href="newsfeed.html" title="">Posted your status. “Hello guys, how are you?”</a></span>
												</div>
											</li>
											<li>
												<div class="activity-meta">
													<i>2 Years Ago</i>
													<span><a href="#" title="">Share a video on her timeline.</a></span>
													<h6>"<a href="newsfeed.html">you are so funny mr.been.</a>"</h6>
												</div>
											</li>
										</ul>
									</div><!-- recent activites -->
									<div class="widget stick-widget">
										<h4 class="widget-title">Who's follownig</h4>
										<ul class="followers">
											<li>
												<figure><img src="images/resources/friend-avatar2.jpg" alt=""></figure>
												<div class="friend-meta">
													<h4><a href="time-line.html" title="">Kelly Bill</a></h4>
													<a href="#" title="" class="underline">Add Friend</a>
												</div>
											</li>
											<li>
												<figure><img src="images/resources/friend-avatar4.jpg" alt=""></figure>
												<div class="friend-meta">
													<h4><a href="time-line.html" title="">Issabel</a></h4>
													<a href="#" title="" class="underline">Add Friend</a>
												</div>
											</li>
											<li>
												<figure><img src="images/resources/friend-avatar6.jpg" alt=""></figure>
												<div class="friend-meta">
													<h4><a href="time-line.html" title="">Andrew</a></h4>
													<a href="#" title="" class="underline">Add Friend</a>
												</div>
											</li>
											<li>
												<figure><img src="images/resources/friend-avatar8.jpg" alt=""></figure>
												<div class="friend-meta">
													<h4><a href="time-line.html" title="">Sophia</a></h4>
													<a href="#" title="" class="underline">Add Friend</a>
												</div>
											</li>
											<li>
												<figure><img src="images/resources/friend-avatar3.jpg" alt=""></figure>
												<div class="friend-meta">
													<h4><a href="time-line.html" title="">Allen</a></h4>
													<a href="#" title="" class="underline">Add Friend</a>
												</div>
											</li>
										</ul>
									</div><!-- who's following -->
								</aside>
							</div><!-- sidebar -->
							<div class="col-lg-6">
								<div class="loadMore">
									{% if request.user.profile.slug == profile.slug %}
									<div class="central-meta item">
										<div class="new-postbox">
											<figure>
												<img src="{{ profile.avatar.url }}" alt="">
											</figure>
											<div class="newpst-input">
												<form action="{% url 'posts:form-create' %}" method="post" enctype="multipart/form-data">
													{% csrf_token %}
													{{ form_post.text }}
													<div class="attachments">
														<ul>
															<li>
																<i class="fa fa-image"></i>
																<label class="fileContainer">
																	{{ form_post.image }}
																</label>
															</li>
															<li>
																<i class="fa fa-video-camera"></i>
																<label class="fileContainer">
																	{{ form_post.video }}
																</label>
															</li>
															<li>
																<button type="submit">Publish</button>
															</li>
														</ul>
													</div>
												</form>
											</div>
										</div>
									</div><!-- add post new box -->
									{% endif %}
									{% for post in profile.get_post_list %}
									<div class="central-meta item">
										<div class="user-post">
											<div class="friend-info">
												<figure>
													<img src="{{ profile.avatar.url }}" alt="">
												</figure>
												<div class="friend-name ">
													<ins>
														<a href="time-line.html" title="">{{ profile.first_name }} {{ profile.last_name }}</a>
													</ins>
													<span>{{ post.created_date }}</span>
													{% if request.user.profile == post.author %}
													<form action="{% url 'posts:post-delete' pk=post.pk %}" method="post" class="delete-btn">
														{% csrf_token %}
														<button type="submit" class="btn btn-outline-danger btn-sm">Удалить</button>
													</form>
													{% endif %}
												</div>
												<div class="post-meta">
													{% if post.image %}
													<img src="{{ post.image.url }}" alt="">
													{% endif %}
													<div class="we-video-info">
														<ul>

															<li>
																<span class="views" data-toggle="tooltip" title="views">
																	<i class="fa fa-eye"></i>
																	<ins>1.2k</ins>
																</span>
															</li>
															<li>
																<span class="comment" data-toggle="tooltip" title="Comments">
																	<i class="fa fa-comments-o"></i>
																	<ins>{{ post.comments.count }}</ins>
																</span>
															</li>
															<li>
																<form action="{% url 'posts:post-like' %}" method="post">
																	{% csrf_token %}
																<span class="like" data-toggle="tooltip" title="like">
																		<i class="ti-heart icon-custom"><button type="submit" class="btn-custom"></button></i>
																	<input type="hidden" name="post_id" value="{{ post.id }}">
																	<ins>{{ post.liked.count }}</ins>
																</span>
																	</form>
															</li>
															<li>
																<form action="{% url 'posts:post-dislike' %}" method="post">
																	{% csrf_token %}
																<span class="dislike" data-toggle="tooltip" title="dislike">
																	<i class="ti-heart-broken icon-custom"><button type="submit" class="btn-custom"></button></i>
																	<input type="hidden" name="post_id" value="{{ post.id }}">
																	<ins>{{ post.disliked.count }}</ins>
																</span>
																</form>
															</li>
															<li class="social-media">
																<div class="menu">
																  <div class="btn trigger"><i class="fa fa-share-alt"></i></div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-html5"></i></a></div>
																  </div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-facebook"></i></a></div>
																  </div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-google-plus"></i></a></div>
																  </div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-twitter"></i></a></div>
																  </div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-css3"></i></a></div>
																  </div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-instagram"></i></a>
																	</div>
																  </div>
																	<div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-dribbble"></i></a>
																	</div>
																  </div>
																  <div class="rotater">
																	<div class="btn btn-icon"><a href="#" title=""><i class="fa fa-pinterest"></i></a>
																	</div>
																  </div>

																</div>
															</li>
														</ul>
													</div>
													<div class="description">

														<p>
															{{ post.text }}
														</p>
													</div>
												</div>
											</div>
											<div class="coment-area">
												<ul class="we-comet">
													{% for comment in post.comments.all %}
													<li>
														<div class="comet-avatar">
															<img src="{{ comment.author.avatar.url }}" alt="">
														</div>
														<div class="we-comment">
															<div class="coment-head">
																<h5><a href="time-line.html" title="">{{ comment.author.first_name }} {{ comment.author.last_name }}</a></h5>
																<span>{{ comment.created_date }}</span>
																<a class="we-reply" href="#" title="Reply"><i class="fa fa-reply"></i></a>
																{% if request.user.profile == comment.author %}
																	<i class="bi bi-x-circle delete-com icon-custom">
																		<form action="{% url 'posts:comment-delete' %}" method="post">
																			{% csrf_token %}
																			<button type="submit" class="btn-custom"></button>
																			<input type="hidden" name="comment_id" value="{{ comment.id }}">
																		</form>
																	</i>
																{% endif %}
															</div>
															<p>{{ comment.text }}</p>
														</div>
													</li>
													{% endfor %}
													<li>
														<a href="#" title="" class="showmore underline">more comments</a>
													</li>
													<li class="post-comment">
														<div class="comet-avatar">
															<img src="images/resources/comet-1.jpg" alt="">
														</div>
														<div class="post-comt-box">
															{% if request.user.is_authenticated %}
															<form action="{% url 'posts:comment-create' %}" method="post">
																{% csrf_token %}
																{{ form_comment.text }}
																<input type="hidden" name="post_id" value="{{ post.id }}">
																<button type="submit">Оставить</button>
															</form>
															{% endif %}
														</div>
													</li>
												</ul>
											</div>
										</div>
									</div>
									{% endfor %}
								</div>
							</div><!-- centerl meta -->
							<div class="col-lg-3">
								<aside class="sidebar static">
									<div class="widget friend-list stick-widget">
										<h4 class="widget-title">Friends</h4>
										<div id="searchDir"></div>
										<ul id="people-list" class="friendz-list">
											{% for friend in profile.get_friends_list %}
											<li>
												<figure>
													<a href="#"><img src="{{ friend.avatar.url }}" alt=""></a>
													<span class="status f-online"></span>
												</figure>
												<div class="friendz-meta">
													<a href="time-line.html">{{ friend.first_name }} {{ friend.last_name }}</a>
													<i><a href="{{ friend.get_absolute_url }}">@{{ friend.user }}</a></i>
												</div>
											</li>
											{% endfor %}
										</ul>
									</div><!-- friends list sidebar -->
								</aside>
							</div><!-- sidebar -->
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

<div id="changeBackground" class="modal fade">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Загрузить фон</h4>
			</div>
			<form action="{% url 'profiles:update-avatar' slug=profile.slug %}" method="post" enctype="multipart/form-data">
			<div class="modal-body">
					{% csrf_token %}
					{{ form_avatar.background }}
				<input type="hidden" name="profile_slug" value="{{ profile.slug }}">
			</div>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary">Сохранить</button>
				<button class="btn btn-danger" data-dismiss="modal">Закрыть</button>
			</div>
				</form>
		</div>
	</div>
</div>

<!--modal change avatar-->
<div id="changeAvatar" class="modal fade">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Загрузить аватар</h4>
			</div>
			<form action="{% url 'profiles:update-avatar' slug=profile.slug %}" method="post" enctype="multipart/form-data">
			<div class="modal-body">
					{% csrf_token %}
					{{ form_avatar.avatar }}
				<input type="hidden" name="profile_slug" value="{{ profile.slug }}">
			</div>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary">Сохранить</button>
				<button class="btn btn-danger" data-dismiss="modal">Закрыть</button>
			</div>
				</form>
		</div>
	</div>
</div>

{% endblock content %}
